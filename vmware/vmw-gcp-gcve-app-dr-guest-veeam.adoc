---
sidebar: sidebar 
permalink: vmware/vmw-gcp-gcve-app-dr-guest-veeam.html 
keywords: gcp, gcve, snapcenter, cvo, iscsi, guest connect, dr, disaster recovery 
summary: Die Notfallwiederherstellung in der Cloud ist eine robuste und kostengünstige Möglichkeit, Workloads vor Site-Ausfällen und Datenbeschädigungen wie Ransomware zu schützen.  Mit NetApp SnapMirror können lokale VMware-Workloads, die über den Gast verbundenen Speicher verwenden, auf NetApp Cloud Volumes ONTAP repliziert werden, das in Google Cloud ausgeführt wird. 
---
= Anwendungs-Notfallwiederherstellung mit SnapCenter, Cloud Volumes ONTAP und Veeam Replication
:hardbreaks:
:allow-uri-read: 
:nofooter: 
:icons: font
:linkattrs: 
:imagesdir: ../media/


[role="lead"]
Die Notfallwiederherstellung in der Cloud ist eine robuste und kostengünstige Möglichkeit, Workloads vor Site-Ausfällen und Datenbeschädigungen wie Ransomware zu schützen.  Mit NetApp SnapMirror können lokale VMware-Workloads, die über den Gast verbundenen Speicher verwenden, auf NetApp Cloud Volumes ONTAP repliziert werden, das in Google Cloud ausgeführt wird.



== Überblick

Dies umfasst Anwendungsdaten. Was ist jedoch mit den eigentlichen VMs selbst?  Die Notfallwiederherstellung sollte alle abhängigen Komponenten abdecken, einschließlich virtueller Maschinen, VMDKs, Anwendungsdaten und mehr.  Um dies zu erreichen, kann SnapMirror zusammen mit Veeam verwendet werden, um Workloads, die von lokalen Standorten auf Cloud Volumes ONTAP repliziert wurden, nahtlos wiederherzustellen, während vSAN-Speicher für VM VMDKs verwendet wird.

Dieses Dokument bietet eine schrittweise Anleitung zum Einrichten und Durchführen einer Notfallwiederherstellung unter Verwendung von NetApp SnapMirror, Veeam und der Google Cloud VMware Engine (GCVE).

image:dr-cvo-gcve-001.png["Abbildung, die einen Eingabe-/Ausgabedialog zeigt oder schriftlichen Inhalt darstellt"]



== Annahmen

Dieses Dokument konzentriert sich auf die In-Guest-Speicherung für Anwendungsdaten (auch als Gastverbindung bezeichnet) und wir gehen davon aus, dass die lokale Umgebung SnapCenter für anwendungskonsistente Sicherungen verwendet.


NOTE: Dieses Dokument gilt für alle Sicherungs- oder Wiederherstellungslösungen von Drittanbietern.  Befolgen Sie je nach der in der Umgebung verwendeten Lösung Best Practices, um Sicherungsrichtlinien zu erstellen, die den SLAs des Unternehmens entsprechen.

Verwenden Sie für die Konnektivität zwischen der lokalen Umgebung und dem Google Cloud-Netzwerk Konnektivitätsoptionen wie dedizierte Verbindung oder Cloud-VPN.  Segmente sollten basierend auf dem lokalen VLAN-Design erstellt werden.


NOTE: Es gibt mehrere Optionen zum Verbinden lokaler Rechenzentren mit Google Cloud, weshalb wir in diesem Dokument keinen bestimmten Arbeitsablauf beschreiben können.  Informationen zur entsprechenden Methode zur Konnektivität zwischen lokalen Standorten und Google finden Sie in der Google Cloud-Dokumentation.



== Bereitstellen der DR-Lösung



=== Übersicht über die Lösungsbereitstellung

. Stellen Sie sicher, dass Anwendungsdaten mit SnapCenter unter Einhaltung der erforderlichen RPO-Anforderungen gesichert werden.
. Stellen Sie Cloud Volumes ONTAP mit der richtigen Instanzgröße bereit, indem Sie den Cloud Manager innerhalb des entsprechenden Abonnements und virtuellen Netzwerks verwenden.
+
.. Konfigurieren Sie SnapMirror für die relevanten Anwendungsvolumes.
.. Aktualisieren Sie die Sicherungsrichtlinien in SnapCenter , um SnapMirror -Updates nach den geplanten Jobs auszulösen.


. Installieren Sie die Veeam-Software und beginnen Sie mit der Replikation virtueller Maschinen auf die Google Cloud VMware Engine-Instanz.
. Unterbrechen Sie im Katastrophenfall die SnapMirror Beziehung mithilfe von Cloud Manager und lösen Sie mit Veeam ein Failover virtueller Maschinen aus.
+
.. Verbinden Sie die ISCSI-LUNs und NFS-Mounts für die Anwendungs-VMs erneut.
.. Rufen Sie Anwendungen online auf.


. Rufen Sie ein Failback zur geschützten Site auf, indem Sie SnapMirror nach der Wiederherstellung der primären Site rückwärts neu synchronisieren.




=== Bereitstellungsdetails

.Konfigurieren Sie CVO in Google Cloud und replizieren Sie Volumes nach CVO
[%collapsible%open]
====
Der erste Schritt besteht darin, Cloud Volumes ONTAP auf Google Cloud zu konfigurieren (link:vmw-gcp-gcve-guest-storage.html#gcp-cvo["cvo"^] ) und replizieren Sie die gewünschten Volumes mit den gewünschten Frequenzen und Snapshot-Aufbewahrungen auf Cloud Volumes ONTAP .

image:dr-cvo-gcve-002.png["Abbildung, die einen Eingabe-/Ausgabedialog zeigt oder schriftlichen Inhalt darstellt"]

Eine Schritt-für-Schritt-Anleitung zum Einrichten von SnapCenter und zum Replizieren der Daten finden Sie unterlink:vmw-aws-vmc-guest-storage-dr.html#config-snapmirror["Einrichten der Replikation mit SnapCenter"]

.Einrichten der Replikation mit SnapCenter
video::395e33db-0d63-4e48-8898-b01200f006ca[panopto]
====
.Konfigurieren Sie GCVE-Hosts und CVO-Datenzugriff
[%collapsible%open]
====
Zwei wichtige Faktoren, die bei der Bereitstellung des SDDC berücksichtigt werden müssen, sind die Größe des SDDC-Clusters in der GCVE-Lösung und die Dauer der Betriebsdauer des SDDC.  Diese beiden wichtigen Überlegungen für eine Disaster-Recovery-Lösung tragen zur Senkung der Gesamtbetriebskosten bei.  Das SDDC kann aus nur drei Hosts bestehen, bei einer vollständigen Bereitstellung kann es aber auch ein Cluster mit mehreren Hosts sein.

Cloud Volumes ONTAP kann auf jedem VPC bereitgestellt werden und GCVE sollte über eine private Verbindung zu diesem VPC verfügen, damit die VM eine Verbindung zu iSCSI-LUNs herstellen kann.

Informationen zum Konfigurieren von GCVE SDDC finden Sie unterlink:vmw-gcp-gcve-setup.html["Bereitstellen und Konfigurieren der Virtualisierungsumgebung auf der Google Cloud Platform (GCP)"^] .  Stellen Sie als Voraussetzung sicher, dass die auf den GCVE-Hosts befindlichen Gast-VMs nach dem Herstellen der Verbindung Daten von Cloud Volumes ONTAP nutzen können.

Nachdem Cloud Volumes ONTAP und GCVE ordnungsgemäß konfiguriert wurden, beginnen Sie mit der Konfiguration von Veeam, um die Wiederherstellung lokaler Workloads auf GCVE (VMs mit Anwendungs-VMDKs und VMs mit In-Guest-Speicher) zu automatisieren. Verwenden Sie dazu die Replikationsfunktion von Veeam und nutzen Sie SnapMirror für Anwendungs-Volume-Kopien auf Cloud Volumes ONTAP.

====
.Veeam-Komponenten installieren
[%collapsible%open]
====
Basierend auf dem Bereitstellungsszenario müssen der Veeam-Sicherungsserver, das Sicherungsrepository und der Sicherungsproxy bereitgestellt werden.  Für diesen Anwendungsfall ist es nicht erforderlich, einen Objektspeicher für Veeam bereitzustellen, und auch ein Scale-Out-Repository ist nicht erforderlich.https://helpcenter.veeam.com/docs/backup/qsg_vsphere/deployment_scenarios.html["Informationen zum Installationsverfahren finden Sie in der Veeam-Dokumentation."]

====
.Einrichten der VM-Replikation mit Veeam
[%collapsible%open]
====
Sowohl das lokale vCenter als auch das GCVE vCenter müssen bei Veeam registriert werden. https://helpcenter.veeam.com/docs/backup/qsg_vsphere/replication_job.html["Einrichten des vSphere VM-Replikationsjobs"]  Wählen Sie im Schritt „Gastverarbeitung“ des Assistenten die Option „Anwendungsverarbeitung deaktivieren“, da wir SnapCenter für die anwendungsbewusste Sicherung und Wiederherstellung verwenden werden.

.Einrichten des vSphere VM-Replikationsjobs
video::8b7e4a9b-7de1-4d48-a8e2-b01200f00692[panopto]
====
.Failover der Microsoft SQL Server-VM
[%collapsible%open]
====
.Failover der Microsoft SQL Server-VM
video::9762dc99-081b-41a2-ac68-b01200f00ac0[panopto]
====


== Vorteile dieser Lösung

* Verwendet die effiziente und stabile Replikation von SnapMirror.
* Stellt mit ONTAP Snapshot-Aufbewahrung alle verfügbaren Zeitpunkte wieder her.
* Für alle erforderlichen Schritte zur Wiederherstellung von Hunderten bis Tausenden von VMs ist eine vollständige Automatisierung verfügbar, angefangen bei den Schritten zur Speicher-, Rechen-, Netzwerk- und Anwendungsvalidierung.
* SnapCenter verwendet Klonmechanismen, die das replizierte Volume nicht ändern.
+
** Dadurch wird das Risiko einer Datenbeschädigung bei Volumes und Snapshots vermieden.
** Vermeidet Replikationsunterbrechungen während DR-Test-Workflows.
** Nutzt die DR-Daten für Workflows, die über DR hinausgehen, wie etwa Entwicklung/Test, Sicherheitstests, Patch- und Upgrade-Tests und Fehlerbehebungstests.


* Die Veeam-Replikation ermöglicht das Ändern von VM-IP-Adressen auf der DR-Site.

